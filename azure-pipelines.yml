

trigger:
- main

pool:
  name: MyAgentPool

steps:
- task: UseDotNet@2
  inputs:
    packageType: 'sdk'
    version: '8.0.x'
  displayName: 'Install .NET SDK'

- script: |
    dotnet restore
    dotnet build --configuration Release
    dotnet pack --configuration Release --output $(Build.ArtifactStagingDirectory)
  displayName: 'Build and Pack NuGet Package'

- script: |
    dotnet nuget push "$(Build.ArtifactStagingDirectory)/*.nupkg" --source "https://pkgs.dev.azure.com/bhewitt3/_packaging/StringExtensionsFeed/nuget/v3/index.json" --api-key AzureArtifacts --skip-duplicate
  displayName: 'Push to Azure Artifacts Feed'

- script: |
    dotnet nuget push "$(Build.ArtifactStagingDirectory)/*.nupkg" --source "StringExtensionsFeed" --username az --password $(System.AccessToken) --skip-duplicate
  displayName: 'Push to Azure Artifacts Feed'
